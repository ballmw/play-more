<!doctype html>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no;"/>
    <title>Play More!</title>

    <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/style.min.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/iphone.css"/>
    <script type="text/javascript" src="assets/js/modernizr-2.0.6.min.js"></script>
    
    <style type="text/css" media="screen">@import "assets/themes/css/jqtouch.css";</style>
    <script type="text/javascript" charset="utf-8" src="cordova-1.8.1.js"></script>

    <script src="assets/js/zepto.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="assets/js/jqtouch.min.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        var jQT = new $.jQTouch({
            icon:'assets/images/play-more.png',
            addGlossToIcon:false,
            startupScreen:'assets/images/play-more-splash.png',
            statusBar:'black'
        });

        function onBodyLoad() {
            document.addEventListener("deviceready", onDeviceReady, false);
        }

        function onDeviceReady() {
            $('#start,#reset').removeAttr('disabled');
            $('#loading').hide();
            $('#start').click(function () {
                StopWatch.start(this, $('#clock'));
                $('#app').show();
                Map.start();
                if ($('#no-music').is(':checked')) {
                    $("#player")[0].pause();
                }
            });
            $('#reset').click(function () {
                StopWatch.reset();
                Map.reset();
                $('#app').hide();
                $("#player")[0].currentTime = 0;
            });
            $('#no-music').click(function () {
                if ($("#no-music").is(":checked")) {
                    return $("#player")[0].pause();
                } else {
                    return $("#player")[0].play();
                }
            });
            $('#save').click(function () {
                $.ajax({
                    type:'POST',
                    dataType:'jsonp',
                    url:$('#save').attr('rel'),
                    data:{
                        'workout.id':'',
                        'workout.title':'Skiing at Winter Park',
                        'workout.description':'On a Blue Bird Day!',
                        'workout.duration':$('#clock').val(),
                        'workout.distance':$('#distance').text()
                    },
                    error:function () {
                        return alert('Posting failed, please try again.');
                    },
                    success:function (data) {
                        var alert, msg;
                        $('.alert-message').remove();
                        msg = 'Your workout was posted!';
                        alert = $('<div class="alert-message success fade in" data-alert="alert">');
                        alert.html('<a class="close" href="#">&times;</a>' + msg);
                        return alert.insertBefore($('.span10'));
                    }
                });
            });
        }
    </script>
    <style type="text/css" media="screen">
        #jqt.fullscreen #home .info {
            display: none;
        }
        div#jqt #about {
            padding: 100px 10px 40px;
            text-shadow: rgba(0, 0, 0, 0.3) 0px -1px 0;
            color: #999;
            font-size: 13px;
            text-align: center;
            background: #161618;
        }
        div#jqt #about p {
            margin-bottom: 8px;
        }
        div#jqt #about a {
            color: #fff;
            font-weight: bold;
            text-decoration: none;
        }
    </style>
</head>
<body class="home index" onload="onBodyLoad()">
<div id="jqt">
    <div id="about" class="selectable">
        <p><img src="assets/images/play-more.png" /></p>
        <p><strong>Play More!</strong><br>Version 1.0 beta<br>
        <a href="http://www.raibledesigns.com">By Matt Raible</a></p>
        <p><em>An HTML5 Fitness Tracker application<br/>created with HTML5, CoffeeScript,<br/>Play Framework, PhoneGap.</em></p>
        <p style="margin-top: 10px">
        <a target="_blank" href="http://twitter.com/mraible">@mraible on Twitter</a>
        </p>
        <p><br><br><a href="#" class="grayButton goback">Close</a></p>
    </div>
    <div id="home" class="current">
        <div class="toolbar">
            <h1>Play More!</h1>
            <a class="button slideup" id="infoButton" href="#about">About</a>
        </div>

      <div class="container">
          <div class="content">
              <div class="row">
                  <div class="span10">
                      <div id="display">
                          <input id="clock" class="xlarge" type="text" value="00:00:00.0" readonly="readonly"/>
                      </div>
                      <div id="controls">
                          <button id="start" type="button" class="btn primary" disabled>Start</button>
                          <button id="reset" type="button" class="btn :disabled" disabled>Reset</button>
                          <div id="options"><input type="checkbox" id="no-music" checked> No Music Please</div>
                      </div>
                      <div id="loading"><img src="assets/images/ajax-loader.gif" alt="Loading"> Loading...</div>
                      <div id="app" style="display: none">
                          <div id="track">
                              Distance Traveled: <span id="distance">0</span> mile(s)
                              <div id="actions">
                                  <button id="save" type="submit" class="btn success"
                                      rel="http://play-more.com/profile/postworkout">Save</button>
                              </div>
                          </div>
                          <div id="where">
                              <div id="map" class="odometer-map"></div>
                              <p id="location">
                                  <span class="label success">New</span>
                                  Fetching your location with HTML 5 geolocation...
                              </p>
                          </div>
                          <div id="music">
                              <audio controls="controls" id="player" preload="auto" autobuffer="true">
                                  <source src="http://dl.dropbox.com/u/3486601/Music/Thunderstruck.ogg"
                                          type="audio/ogg"></source>
                                  <source src="http://dl.dropbox.com/u/3486601/Music/Thunderstruck.mp3"
                                          type="audio/mp3"></source>
                                  Your browser does not support the audio tag.
                              </audio>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
    </div>
</div>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript" src="assets/js/map.js"></script>
<script type="text/javascript" src="assets/js/stopwatch.js"></script>
<script type="text/javascript" src="assets/js/odometer.js"></script>
<script type="text/javascript" src="assets/js/playmore.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-alerts.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-tabs.js"></script>
<script type='text/javascript'>
    //<![CDATA[
    window._gaq = [
        ['_setAccount','UA-25859875-1'],
        ['_trackPageview'],
        ['_trackPageLoadTime']
    ];
    Modernizr.load({
        load: ('https:' == location.protocol ? '//ssl' : '//www') + '.google-analytics.com/ga.js'
    });
    $('.nav').tabs()
    var year = (new Date()).getFullYear();
    if (year > 2011) {
        $('.copy-year').html(year);
    }
    //]]>
</script>
</body>
</html>